{% extends 'base.html' %}

{% block js %}
    {{ super() }}
    <script>
        submitVoteUrl = "{{ url_for('api.submit_vote') }}"
    </script>
    <script src="{{ url_for('static', filename='js/polls/send-vote.js') }}" defer></script>
{% endblock js %}

{% block content %}
<section class="voting-container">
    {% if poll %}
        <div class='window-background'>
            <form id='voting-form'>
                <h2>{{ poll.title }}</h2>
                <p>{{ poll.description }}</p>
                {% if not voted_before %}
                    {% with radio_box_class='choice-input' %}
                        {% include 'render_poll_form.html' %}
                    {% endwith %}
                    <input type="button" value="Vote" id='voting-form-submit'>
                {% else %}
                    {% for choice in poll.choices %}
                        <div class="choice-box">
                            <div>
                                <span class="vote-percent">{{choice.current_percent|int}}%</span>
                                {{ choice.text }}
                            </div>
                            <div class="progressbar">
                                <div style="width: {{choice.current_percent}}%;"></div>
                            </div>
                        </div>
                    {% endfor %}
                {% endif %}
                <p>Ending on {{ poll.expires_on.strftime('%d-%m-%Y at %H:%M') }}</p>
            </form>
        </div>
    {% else %}
        <h2>There are no active polls at the moment.</h2>
    {% endif %}
    {% if voted_before %}
        <p>Thank you for your vote!</p>
    {% endif %}
    <p>Check the <a href="{{url_for('frontend.poll_archive')}}">Archive</a> to see previous polls.</p>

</section>
{% endblock content %}